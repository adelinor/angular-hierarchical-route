<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>angular-hierarchical-route by adelinor</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>angular-hierarchical-route</h1>
        <h2>Helps the definition and usage of routes in an AngularJS app</h2>
        <a href="https://github.com/adelinor/angular-hierarchical-route" class="button"><small>View project on</small> GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <p>This is an illustrated introduction to the <code>angular-hierarchical-route</code> module which purpose is to help you build and use routes in your AngularJS app.
The <a href="https://github.com/adelinor/angular-hierarchical-route/blob/master/README.md">README file</a> provides a more succinct version of this content.</p>

<p><img src="content_img/intro_with_ctrl.png" alt="introduction with controller"></p>

<h3>
<a id="1-building-routes" class="anchor" href="#1-building-routes" aria-hidden="true"><span class="octicon octicon-link"></span></a>[1] Building routes</h3>

<p>Before the app starts offering its services to the users, the route gets assembled ...</p>

<p><img src="content_img/route_construction.png" alt="route construction"></p>

<p>... with the <code>$routeProvider</code> of <code>ngRoute</code> when configuring your application AngularJS module:</p>

<div class="highlight highlight-js"><pre>angular.module(<span class="pl-s1"><span class="pl-pds">'</span>sample.routes<span class="pl-pds">'</span></span>, [<span class="pl-s1"><span class="pl-pds">'</span>ngRoute<span class="pl-pds">'</span></span>])
.config([<span class="pl-s1"><span class="pl-pds">'</span>$routeProvider<span class="pl-pds">'</span></span>, <span class="pl-st">function</span>(<span class="pl-vpf">$routeProvider</span>) {

    $routeProvider.when(<span class="pl-s1"><span class="pl-pds">'</span>/home<span class="pl-pds">'</span></span>, {templateUrl<span class="pl-k">:</span> <span class="pl-s1"><span class="pl-pds">'</span>home/home.html<span class="pl-pds">'</span></span>,
                                  controller<span class="pl-k">:</span> <span class="pl-s1"><span class="pl-pds">'</span>HomeCtrl<span class="pl-pds">'</span></span>});
    <span class="pl-c">// ...</span>
}]);</pre></div>

<p>When you want to associate <strong>several routes to a view</strong> (displayed with the <code>ng-view</code> directive), you can use this module to create a hierarchical route. A <strong>hierarchical route</strong> functions like an <strong>underground line</strong>:</p>

<p><img src="content_img/underground_line.png" alt="underground line"></p>

<p>It has places where you can join and stop: similar to the <strong>stations</strong> of an underground line.
This metaphor also applies to the relationship between a <em>hierarchical route</em> and a <em>route</em>: a route
belongs to a hierarchical route in the same way as a station belongs to an underground line.</p>

<h3>
<a id="2-defining-hierarchical-routes" class="anchor" href="#2-defining-hierarchical-routes" aria-hidden="true"><span class="octicon octicon-link"></span></a>[2] Defining hierarchical routes</h3>

<p>To define a hierarchical route, you need to inject the <code>hierarchyProvider</code> in the config method of your module:</p>

<div class="highlight highlight-js"><pre>angular.module(<span class="pl-s1"><span class="pl-pds">'</span>sample.routes<span class="pl-pds">'</span></span>, [<span class="pl-s1"><span class="pl-pds">'</span>ngRoute<span class="pl-pds">'</span></span>, <span class="pl-s1"><span class="pl-pds">'</span>angularHierarchicalRoute<span class="pl-pds">'</span></span>])
.config([<span class="pl-s1"><span class="pl-pds">'</span>$routeProvider<span class="pl-pds">'</span></span>, <span class="pl-s1"><span class="pl-pds">'</span>hierarchyProvider<span class="pl-pds">'</span></span>,
         <span class="pl-st">function</span>(<span class="pl-vpf">$routeProvider</span>, <span class="pl-vpf">hierarchyProvider</span>) {

    hierarchyProvider.<span class="pl-s3">add</span>({
        rootPath<span class="pl-k">:</span> <span class="pl-s1"><span class="pl-pds">'</span>/home<span class="pl-pds">'</span></span>,
        templateUrl<span class="pl-k">:</span> <span class="pl-s1"><span class="pl-pds">'</span>home/home.html<span class="pl-pds">'</span></span>,
        controller<span class="pl-k">:</span> <span class="pl-s1"><span class="pl-pds">'</span>HomeCtrl<span class="pl-pds">'</span></span>})
    .callableFrom(<span class="pl-s1"><span class="pl-pds">'</span>/home<span class="pl-pds">'</span></span>,<span class="pl-s1"><span class="pl-pds">'</span>home<span class="pl-pds">'</span></span>)
    .callableFrom(<span class="pl-s1"><span class="pl-pds">'</span>/home/:countryId<span class="pl-pds">'</span></span>,<span class="pl-s1"><span class="pl-pds">'</span>choose city<span class="pl-pds">'</span></span>)
    <span class="pl-c">// ... </span>
    .registerWith($routeProvider);</pre></div>

<p><img src="content_img/station.png" alt="station called 'choose city'"></p>

<p>All routes in the hierarchy share the same view and controller. The <code>rootPath</code> must be one of the routes in your hierarchy and is the default entry point to your view.
Finally you register your hierarchical route with <code>$routeProvider</code> .</p>

<p>When all your routes are created, your application can start receiving users.</p>

<p><img src="content_img/users_en_route.png" alt="users on your route"></p>

<h3>
<a id="3-users-on-your-route" class="anchor" href="#3-users-on-your-route" aria-hidden="true"><span class="octicon octicon-link"></span></a>[3] Users on your route</h3>

<p>Users (the vehicle on the photo) will be taking the routes defined in your app. When the route they are on corresponds to a <code>callable</code> route (a station), the <strong>controller</strong> will be provided with a resolved object:</p>

<div class="highlight highlight-js"><pre>.controller(<span class="pl-s1"><span class="pl-pds">'</span>HomeCtrl<span class="pl-pds">'</span></span>, [<span class="pl-s1"><span class="pl-pds">'</span>$scope<span class="pl-pds">'</span></span>, <span class="pl-s1"><span class="pl-pds">'</span>resolved<span class="pl-pds">'</span></span>,
                         <span class="pl-st">function</span>(<span class="pl-vpf">$scope</span>, <span class="pl-vpf">resolved</span>) {
    <span class="pl-c">//Set loaded data in scope</span>
    $scope.countries <span class="pl-k">=</span> resolved.countries;
    $scope.cities <span class="pl-k">=</span> resolved.cities;

    <span class="pl-c">//...</span>
}])</pre></div>

<p>This object is a map of the data to resolve.</p>

<p><img src="content_img/ctrl_resolved.png" alt="Controller receives resolved"></p>

<p>The data to resolve is defined when creating the callable route:
<img src="content_img/resolved_open.png" alt="What's in resolved?"></p>

<div class="highlight highlight-js"><pre>.callableFrom(<span class="pl-s1"><span class="pl-pds">'</span>/home/:countryId<span class="pl-pds">'</span></span>,<span class="pl-s1"><span class="pl-pds">'</span>choose city<span class="pl-pds">'</span></span>)
    .resolve({
        countries<span class="pl-k">:</span> annotatedFnCountries,
        cities<span class="pl-k">:</span> annotatedFnCities
    })</pre></div>

<p>where <code>annotatedFnCountries</code> and <code>annotatedFnCities</code> are functions returning promises with annotations to inject dependencies:</p>

<div class="highlight highlight-js"><pre><span class="pl-s">var</span> annotatedFnCountries <span class="pl-k">=</span> [<span class="pl-s1"><span class="pl-pds">'</span>adminService<span class="pl-pds">'</span></span>,
    <span class="pl-st">function</span>(<span class="pl-vpf">adminService</span>) {
        <span class="pl-k">return</span> adminService.countries();
    }];

<span class="pl-s">var</span> annotatedFnCities <span class="pl-k">=</span> [<span class="pl-s1"><span class="pl-pds">'</span>adminService<span class="pl-pds">'</span></span>, <span class="pl-s1"><span class="pl-pds">'</span>$route<span class="pl-pds">'</span></span>,
    <span class="pl-st">function</span>(<span class="pl-vpf">adminService</span>, <span class="pl-vpf">$route</span>) {
        <span class="pl-k">return</span> adminService.citiesForCountry($route.<span class="pl-sc">current</span>.params.countryId);
    }];</pre></div>

<h3>
<a id="4-route-guidance" class="anchor" href="#4-route-guidance" aria-hidden="true"><span class="octicon octicon-link"></span></a>[4] Route guidance</h3>

<p>The <strong>controller</strong> also gets provided a <code>routeCalled</code> object which acts as a guidance leaflet to:</p>

<ul>
<li>know where you are</li>
<li>access ngRoute's services: <code>$route</code>, <code>$location</code> and <code>$routeParams</code>
</li>
<li>navigate to other stations in the line</li>
</ul>

<p><img src="content_img/ctrl_route_called.png" alt="routeCalled to controller"></p>

<h3>
<a id="5-view-constants" class="anchor" href="#5-view-constants" aria-hidden="true"><span class="octicon octicon-link"></span></a>[5] View constants</h3>

<p>Similar to the promises to resolve, your can define constants that will be passed to the <strong>controller</strong> when a user is at your station.</p>

<p>For example:</p>

<div class="highlight highlight-js"><pre>.callableFrom(<span class="pl-s1"><span class="pl-pds">'</span>/home/:countryId/:cityId<span class="pl-pds">'</span></span>,<span class="pl-s1"><span class="pl-pds">'</span>current<span class="pl-pds">'</span></span>)
    .constants({weatherView<span class="pl-k">:</span> <span class="pl-s1"><span class="pl-pds">'</span>home/current-weather.html<span class="pl-pds">'</span></span>})</pre></div>

<p>is made available to the controller under the name <code>constants</code>:</p>

<div class="highlight highlight-js"><pre>.controller(<span class="pl-s1"><span class="pl-pds">'</span>HomeCtrl<span class="pl-pds">'</span></span>, [<span class="pl-s1"><span class="pl-pds">'</span>$scope<span class="pl-pds">'</span></span>, <span class="pl-s1"><span class="pl-pds">'</span>constants<span class="pl-pds">'</span></span>,
                         <span class="pl-st">function</span>(<span class="pl-vpf">$scope</span>, <span class="pl-vpf">constants</span>) {
    <span class="pl-c">//...</span>
    $scope.weatherView <span class="pl-k">=</span> constants.weatherView;
    <span class="pl-c">//...</span>
}])</pre></div>

<p>This mechanism allows to include sub-views with the directive <code>ng-include='*constant*'</code>. This reduces the number of elements in your view that are shown or hidden: <code>ng-show=*toggle*</code>, which as a consequence makes your view more readable.</p>

<p>For instance, what would be in one view as:</p>

<div class="highlight highlight-html"><pre>&lt;<span class="pl-ent">div</span> <span class="pl-e">class</span>=<span class="pl-s1"><span class="pl-pds">"</span>col-xs-6<span class="pl-pds">"</span></span> <span class="pl-e">ng-show</span>=<span class="pl-s1"><span class="pl-pds">"</span>cityId <span class="pl-ii">&amp;&amp;</span> (! forecastMode)<span class="pl-pds">"</span></span>&gt;
    <span class="pl-c">&lt;!-- view content ...--&gt;</span>
&lt;/<span class="pl-ent">div</span>&gt;
&lt;<span class="pl-ent">div</span> <span class="pl-e">class</span>=<span class="pl-s1"><span class="pl-pds">"</span>col-xs-6<span class="pl-pds">"</span></span> <span class="pl-e">ng-show</span>=<span class="pl-s1"><span class="pl-pds">"</span>cityId <span class="pl-ii">&amp;&amp;</span> forecastMode<span class="pl-pds">"</span></span>&gt;
    <span class="pl-c">&lt;!-- view content ...--&gt;</span>
&lt;/<span class="pl-ent">div</span>&gt;  </pre></div>

<p>can now be written as:</p>

<div class="highlight highlight-html"><pre>&lt;<span class="pl-ent">div</span> <span class="pl-e">class</span>=<span class="pl-s1"><span class="pl-pds">"</span>col-xs-6<span class="pl-pds">"</span></span> <span class="pl-e">ng-show</span>=<span class="pl-s1"><span class="pl-pds">"</span>cityId<span class="pl-pds">"</span></span> <span class="pl-e">ng-include</span>=<span class="pl-s1"><span class="pl-pds">"</span>weatherView<span class="pl-pds">"</span></span>&gt;</pre></div>

<h3>
<a id="6-navigation" class="anchor" href="#6-navigation" aria-hidden="true"><span class="octicon octicon-link"></span></a>[6] Navigation</h3>

<p><strong>Go to by name</strong></p>

<p>This is about going to a station in an underground line by knowing the station name. You invoke the routeCalled.goTo function:</p>

<div class="highlight highlight-js"><pre>routeCalled.goTo(<span class="pl-s1"><span class="pl-pds">'</span>choose city<span class="pl-pds">'</span></span>, params);</pre></div>

<p><strong>Go to by parameter signature</strong></p>

<p>As well as you could describe an underground station by its characteristics: "a station with green walls and yellow ceiling", here you identify a station by the keys that are used in the route definition. For instance:</p>

<div class="highlight highlight-js"><pre>routeCalled.goToFirstWith({countryId<span class="pl-k">:</span> value});</pre></div>

<p>would stop at the first callable route within this hierarchical route which has <code>:countryId</code> as a key in the route and nothing else.</p>

<p><strong>Update current parameters or go to by parameter signature</strong></p>

<p>If the user updates the content an existing route parameter, the <code>routeCalled.updateOrGoToFirstWith</code> function will stay on the same view but updated parameters.</p>

<p>When new parameter is added, the <code>routeCalled.updateOrGoToFirstWith</code> function will search for a callable for this new set of parameter keys. In this case this works as the routeCalled.goToFirstWith function.</p>

<div class="highlight highlight-js"><pre>routeCalled.updateOrGoToFirstWith({countryId<span class="pl-k">:</span> value, cityId<span class="pl-k">:</span> newValue});</pre></div>

<p><img src="content_img/thankyoubye.png" alt="Thank you and bye"></p>

<p>Thank your for your attention.</p>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/adelinor/angular-hierarchical-route/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/adelinor/angular-hierarchical-route/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/adelinor/angular-hierarchical-route"></a> is maintained by <a href="https://github.com/adelinor">adelinor</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>
